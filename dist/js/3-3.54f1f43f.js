(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{686:function(e,t,n){},687:function(e,t,n){e.exports={style:"_3hdTa_mbj1YVzvDPW6_xfe"}},688:function(e,t,n){e.exports={style:"_3b-1gnSQ_2ipjAaPklMvmX"}},698:function(e,t,n){"use strict";n.r(t);n(378);var a=n(188),r=(n(107),n(61)),i=(n(606),n(616)),o=(n(45),n(11)),c=n(1),l=n.n(c),u=n(597),s=n(101),f=n(150),m=n(108),p=(n(92),n(42)),d=(n(106),n(58)),_=(n(51),n(19)),h=(n(684),n(690)),b=n(349),y=function(e){var t=e.onClick,n=e.text,a=e.children;return l.a.createElement("div",{onClick:t,className:"contextMenu-option",__source:{fileName:"/lwh/mycode/back-stage/src/components/right_menu/menu_option.jsx",lineNumber:4}},a||n||"")},N=n(0),g=n.n(N),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(686);var k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:n.props.visible},n.menuRoot=l.a.createRef(),n.style={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c["Component"]),v(t,[{key:"componentDidMount",value:function(){this.getMenuPosition(),document.addEventListener("click",this.props.closeMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.props.closeMenu)}},{key:"componentDidUpdate",value:function(){this.getMenuPosition()}},{key:"getMenuPosition",value:function(){var e=this.menuRoot.current,t=this.props,n=t.clickX,a=t.clickY,r=window.innerWidth,i=window.innerHeight,o=e.offsetWidth,c=e.offsetHeight,l=r-n>o,u=!l,s=i-a>c,f=!s;l&&(e.style.left=n+"px"),u&&(e.style.left=n-o+"px"),s&&(e.style.top=a+"px"),f&&(e.style.top=a-c+"px")}},{key:"render",value:function(){return l.a.createElement("div",{ref:this.menuRoot,style:this.style,className:"contextMenu-wrap",__source:{fileName:"/lwh/mycode/back-stage/src/components/right_menu/index.jsx",lineNumber:66}},this.props.children)}}]),t}();k.propTypes={visible:g.a.bool.isRequired,closeMenu:g.a.func.isRequired,children:g.a.arrayOf(g.a.instanceOf(y))};var E=k,w=n(687),C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},S="/lwh/mycode/back-stage/src/components/tree_class/index.jsx",O=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var P=h.a.DirectoryTree,j=h.a.TreeNode,I=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return n=a=x(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.state={tree:a.props.data,rightClickItemInfo:{key:"all",isLeaf:!1},selectedKey:"all"},a.onSelect=function(e,t){var n=e[0];n!==a.state.selectedKey&&a.setState({selectedKey:n},function(){return a.props.getList(a.state.selectedKey)})},a.onConfirm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2],r=t,i=function(e){r=e.target.value},o={okText:"保存",cancelText:"取消",iconType:"pushpin"};switch(e){case"add":o.content=l.a.createElement(_.a,{defaultValue:t,onChange:function(e){return i(e)},placeholder:"请输入分类名",__source:{fileName:S,lineNumber:48}}),o.onOk=function(){return a.onAdd(r,n)},o.title="添加分类";break;case"rename":console.log("name:",t),o.content=l.a.createElement(_.a,{defaultValue:t,onChange:function(e){return i(e)},placeholder:"请输入分类名",__source:{fileName:S,lineNumber:54}}),o.onOk=function(){a.onEdit("rename",r)},o.title="类目重命名",o.iconType="edit";break;case"delete":o.content=l.a.createElement("p",{__source:{fileName:S,lineNumber:61}},"删除后，该类目及其子类目都见被移除，是否确认删除！"),o.onOk=function(){return a.onEdit()},o.title="类目删除",o.okText="删除",o.okType="danger",o.iconType="delete"}d.a.confirm(o)},a.onAdd=function(e,t){var n=a.state,r=n.rightClickItemInfo,i=n.tree,o=r.parentId,c=t||r.key,l={},u=void 0;"all"===c?(l.name=e,u=a.hasSameName(e,!1)):(l={key:c,name:e,parentId:o},u=a.hasSameName(e)),u?p.a.error("该类别已经存在"):a.props.addClass(C({},l)).then(function(e){var t="all"===c?i.concat(e.data):i.map(function(t){return t._id===o&&t.leaf.push(e.data),t});a.setState({tree:t}),p.a.success(e.msg)})},a.onEdit=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"delete",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=a.state,r=n.rightClickItemInfo,i=n.tree,o=r.key,c=r.parentId,l=r.isLeaf,u=i;if("rename"===e){if(a.hasSameName(t,l))return void p.a.info("该名称已经存在，请重新命名");a.props.putClass({key:o,name:t,parentId:c}).then(function(e){u=l?i.map(function(e){return e._id==c&&e.leaf.forEach(function(e){e._id!=o||(e.name=t)}),e}):i.map(function(e){return e._id==o&&(e.name=t),e}),a.setState({tree:u}),p.a.success(e.msg)})}else a.props.deleteClass({key:o,parentId:c}).then(function(e){u=l?i.map(function(e){return e._id==c&&(e.leaf=e.leaf.filter(function(e){return e._id!=o})),e}):i.filter(function(e){return e._id!=o}),a.setState({tree:u}),p.a.success(e.msg)})},a.hasSameName=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a.state.rightClickItemInfo.parentId,r=a.state.tree,i=!1;return t?r.forEach(function(t){t._id!=n||(i=t.leaf.filter(function(t){return t.name===e}).length>0)}):i=r.filter(function(t){return t.name===e}).length>0,i},a.getMenuName=function(e){var t=a.state.tree,n=e.isLeaf,r=e.parentId,i=e.key,o="";return t.forEach(function(e){n&&e._id==r?e.leaf.forEach(function(e){e._id!=i||(o=e.name)}):e._id!=i||(o=e.name)}),o},a.handleRightClick=function(e){var t="all",n=!1,r="";if(b.a.get(e,"node.props")){var i=e.node.props.eventKey;if("all"===i)return void p.a.warn("根目录不可编辑");t=i,(n=e.node.props.isLeaf||!1)?a.state.tree.forEach(function(e){e.leaf.forEach(function(n){n._id===t&&(r=e._id)})}):r=t}a.setState({clickX:e.event.clientX,clickY:e.event.clientY,rightClickItemInfo:{key:t,parentId:r,isLeaf:n},visible:!0})},a.closeMenu=function(){a.setState({visible:!1})},x(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c["PureComponent"]),O(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.tree,a=t.visible,r=t.clickX,i=t.clickY,c=t.rightClickItemInfo,u=this.props,s=u.name,f=u.title;return l.a.createElement("div",{className:w.style,__source:{fileName:S,lineNumber:242}},f,l.a.createElement(P,{defaultExpandParent:!0,defaultExpandedKeys:["all"],defaultSelectedKeys:["all"],onSelect:this.onSelect,onRightClick:function(t){return e.handleRightClick(t)},__source:{fileName:S,lineNumber:244}},"   ",l.a.createElement(j,{title:"全部"+s,key:"all",__source:{fileName:S,lineNumber:250}},n.map(function(e){return l.a.createElement(j,{title:e.name,key:e._id,__source:{fileName:S,lineNumber:253}},e.leaf&&e.leaf.map(function(e){return l.a.createElement(j,{title:e.name,key:e._id,isLeaf:!0,__source:{fileName:S,lineNumber:256}})}))}))),l.a.createElement("div",{className:"add-tree",onClick:function(){return e.onConfirm("add","","all")},title:"添加分类",__source:{fileName:S,lineNumber:265}},l.a.createElement(o.a,{type:"plus",__source:{fileName:S,lineNumber:266}})),a&&l.a.createElement(E,{clickY:i,visible:a,clickX:r,closeMenu:this.closeMenu,__source:{fileName:S,lineNumber:269}},l.a.createElement(y,{text:"删除",onClick:function(){return e.onConfirm("delete")},__source:{fileName:S,lineNumber:270}}),l.a.createElement(y,{text:"编辑",onClick:function(){return e.onConfirm("rename",e.getMenuName(c))},__source:{fileName:S,lineNumber:271}}),l.a.createElement(y,{text:"添加",onClick:function(){return e.onConfirm("add")},__source:{fileName:S,lineNumber:272}}),l.a.createElement(y,{text:"取消",__source:{fileName:S,lineNumber:273}})))}}]),t}();I.defaultProps={name:"图片",title:l.a.createElement("p",{className:"title",__source:{fileName:S,lineNumber:16}},"类目管理")};var T=I,M=n(688),L=n(30),R=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),A="/lwh/mycode/back-stage/src/pages/product/product_stock/index.jsx";function K(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var D=[{title:"宝贝图片",dataIndex:"images",className:"staff-td",render:function(e){return l.a.createElement("div",{className:"product-img",__source:{fileName:A,lineNumber:20}},l.a.createElement("img",{src:L.i+e[0],__source:{fileName:A,lineNumber:21}}))}},{title:"宝贝标题",dataIndex:"title",key:"title",className:"staff-td"},{title:"购买地址",dataIndex:"buyUrl",className:"staff-td",render:function(e){return l.a.createElement("a",{src:e,__source:{fileName:A,lineNumber:33}},e)}},{title:"添加时间",dataIndex:"time",className:"staff-td",render:function(e){return Object(m.a)(e).fullTime}},{key:"_id",title:"操作",dataIndex:"_id",className:"staff-td",render:function(e){return l.a.createElement("div",{className:"action",__source:{fileName:A,lineNumber:45}},Object(f.b)("product_edit")&&l.a.createElement(u.a,{to:"/product/edit/"+e,className:"outline-btn edit-a",__source:{fileName:A,lineNumber:48}},"编辑"),l.a.createElement(u.a,{to:"/product/info/"+e,className:"btn-style search-a",__source:{fileName:A,lineNumber:50}},"查看"))}}],X=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return n=a=z(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.state={visible:!0,classData:null,dataSource:[],status:0,pageSize:10,total:0,current:1},a.getProductList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=a.state,r=n.dataSource,i=n.pageSize,o=n.status;Object(s.f)({page:e,pageSize:i,typeClass:t,status:o}).then(function(e){var t,n,i=e.data,o=i.data,c=i.pageConfig,l=c.total,u=c.current,s=c.pageSize,f=void 0;r.length!=l?(t=f=new Array(l)).splice.apply(t,[(u-1)*s,s].concat(K(o))):(n=f=r.slice()).splice.apply(n,[(u-1)*s,s].concat(K(o)));a.setState({dataSource:f,total:l,current:u,pageSize:s})})},a.onChangeStatus=function(e){a.setState({status:+e},a.getProductList)},a.onPageChange=function(e,t){a.state.dataSource[(e-1)*t]?a.setState({current:e}):a.getProductList(e)},a.getProductClass=function(){Object(s.d)().then(function(e){a.setState({classData:e.data,visible:!1})})},z(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c["PureComponent"]),R(t,[{key:"componentDidMount",value:function(){Promise.all([this.getProductClass(),this.getProductList()])}},{key:"render",value:function(){var e=this,t=this.state,n=t.classData,c=t.visible,u=t.dataSource,f=t.current,m=t.total,p=t.pageSize;return l.a.createElement("div",{className:M.style,__source:{fileName:A,lineNumber:125}},l.a.createElement(i.a,{defaultActiveKey:"0",onChange:this.onChangeStatus,__source:{fileName:A,lineNumber:126}},l.a.createElement(i.a.TabPane,{tab:l.a.createElement("span",{__source:{fileName:A,lineNumber:127}},l.a.createElement(o.a,{type:"inbox",__source:{fileName:A,lineNumber:127}}),"仓库宝贝"),key:"0",__source:{fileName:A,lineNumber:127}}),l.a.createElement(i.a.TabPane,{tab:l.a.createElement("span",{__source:{fileName:A,lineNumber:128}},l.a.createElement(o.a,{type:"shop",__source:{fileName:A,lineNumber:128}}),"在架宝贝"),key:"1",__source:{fileName:A,lineNumber:128}})),l.a.createElement("div",{className:"container",__source:{fileName:A,lineNumber:130}},l.a.createElement(r.a,{spinning:c,__source:{fileName:A,lineNumber:131}},l.a.createElement("aside",{__source:{fileName:A,lineNumber:132}},n&&l.a.createElement(T,{name:"宝贝",data:n,addClass:s.b,putClass:s.g,deleteClass:s.c,getList:function(t){return e.getProductList(1,t)},__source:{fileName:A,lineNumber:134}}))),l.a.createElement("div",{className:"content",__source:{fileName:A,lineNumber:145}},l.a.createElement(a.a,{rowKey:"_id",dataSource:u,columns:D,pagination:{current:f,total:m,pageSize:p,onChange:this.onPageChange,hideOnSinglePage:!0},__source:{fileName:A,lineNumber:146}}))))}}]),t}();t.default=X}}]);